---
description: Git Workflow and Commit Etiquette
globs:
alwaysApply: true
---

# Git Workflow

When a user asks you to:

- "Create/Write a commit message" → Write the message text only, do NOT run `git commit`
- "Make a commit" → Write a commit message and commit the relevant changes
- "Prepare commits for a PR" → Create a commit for each logical change and then create a PR

## Commit Message Format

Follow this strict format for all commit messages:

### Subject Line

- Use **imperative mood** (e.g., "Add feature" not "Added feature" or "Adds feature")
- **Capitalize** the first word
- **No period** at the end
- Keep it concise (50 characters or less ideally)

**Good examples:**

- `Add MCP server for contract generation`
- `Fix UTF-8 BOM handling in CSV parser`
- `Refactor type detection to scan multiple rows`

**Bad examples:**

- `Added new feature` ❌ (not imperative)
- `add new feature` ❌ (not capitalized)
- `Add new feature.` ❌ (has period)
- `Adds new feature` ❌ (not imperative)

### Body (separated by blank line from subject)

**IMPORTANT**: Make the commit body length proportional to the change affect:

- **Small changes** (removing unused code, fixing typos, minor refactors): 1-2 sentences explaining why
- **Medium changes** (new feature, significant refactor): 1-2 short paragraphs
- **Large changes** (major features, architectural changes): Full detailed explanation

For non-trivial changes, the body should explain:

1. **The WHY**: The motivation, problem, or context (1-3 sentences for small changes, a paragraph for larger ones)
2. **The WHAT** (optional for small changes): What was changed at a general level

**Do NOT include "the HOW"** - the implementation details should be clear from reading the code itself.

**Examples of appropriate length:**

Small change:

```md
Remove unused pandas dependency

The pandas import was never used - the contract generator uses the standard library csv module.

This removes the pandas library from the project.
```

Large change: (see example below)

### Example Commit Message (Large Change)

```md
Add MCP server for data ingestion contract generation

AI agents building data ingestion workflows need structured contracts to
understand data sources, define destinations, and specify transformations.
Manual contract creation is error-prone and time-consuming, especially when
dealing with diverse file formats, international number and date formats,
and data quality issues like UTF-8 BOMs or sparse data.

This introduces an MCP server that provides tools for automatically analyzing
data sources and generating validated contracts. The server handles source
contract generation with automatic schema detection and quality assessment,
destination contract definition with validation rules, and transformation
contract creation that maps source to destination. The implementation uses
Pydantic models for type safety, follows a stateless design returning JSON
contracts, and includes comprehensive test coverage for data quality edge cases.
```

## Fixing misstakes in the same PR

Do not create a new fix commit for something that has not yet been merged to main, instead create a fixup commit and let the user rebase later.
